# 递归PDF分类工具使用说明

## 功能概述

`recursive_pdf_classify.py` 是一个递归PDF分类工具，能够：

1. **递归扫描**：扫描指定文件夹及其所有子文件夹
2. **两阶段验证**：
   - 第一阶段：检查第一特征（白色背景+黑色文字）
   - 第二阶段：检查第二特征（两条长黑横线）
3. **自动复制**：将符合所有标准的PDF文件自动复制到`jc`文件夹

## 使用方法

### 基本用法

```bash
# 扫描指定文件夹下的所有PDF文件
python recursive_pdf_classify.py "F:\标准规范要求\充电"

# 指定自定义目标文件夹
python recursive_pdf_classify.py "F:\标准规范要求\充电" --target "my_output_folder"

# 启用详细输出模式
python recursive_pdf_classify.py "F:\标准规范要求\充电" --verbose
```

### 参数说明

- `source_folder`：必需参数，源文件夹路径
- `--target, -t`：可选参数，目标文件夹路径（默认为`jc`）
- `--verbose, -v`：可选参数，启用详细日志输出

## 工作流程

### 1. 递归扫描
- 扫描源文件夹及其所有子文件夹
- 查找所有`.pdf`文件
- 统计总文件数量

### 2. 第一特征检查
对每个PDF文件的第一页进行以下检查：
- **白色背景比例**：≥ 95%
- **黑色文字比例**：≥ 0.1%
- **整体亮度**：≥ 244
- **对比度**：≥ 26

### 3. 第二特征检查
只有通过第一特征检查的PDF才会进行第二特征检查：
- 检测两条长黑横线
- 验证线条位置和长度
- 计算线条间距

### 4. 文件复制
通过所有检查的PDF文件将被复制到目标文件夹：
- 自动处理文件名冲突（添加序号）
- 保持原始文件不变
- 记录复制路径

## 输出结果

### 控制台输出
```
开始处理PDF文件...
========================================================================================================================
序号 文件名                                            第一特征    第二特征    复制状态    详细信息
----  -------------------------------------------------- ---------- ---------- ---------- ------------------------------
1    example1.pdf                                      ✅ 通过     ✅ 通过     ✅ 已复制    符合标准，已复制
2    example2.pdf                                      ✅ 通过     ❌ 失败     ❌ 未复制    第一特征通过，第二特征失败: 只检测到1条长黑线，要求2条
3    example3.pdf                                      ❌ 失败     ❌ 失败     ❌ 未复制    第一特征失败: 白=85.2%, 黑=0.05%
```

### 统计报告
```
📊 处理统计:
  总PDF文件数: 150
  第一特征通过: 45
  第二特征通过: 12
  成功复制文件: 12
  处理错误: 0

📈 通过率:
  第一特征通过率: 30.0%
  第二特征通过率: 8.0%
  最终复制率: 8.0%
```

### 文件输出
- **日志文件**：`pdf_classify.log`
- **结果文件**：`recursive_classify_results_YYYYMMDD_HHMMSS.json`
- **复制的PDF文件**：目标文件夹（默认为`jc`）

## 示例场景

### 场景1：标准充电规范文档分类
```bash
python recursive_pdf_classify.py "F:\标准规范要求\充电"
```
- 扫描充电规范文件夹
- 识别符合标准的PDF文档
- 复制到`jc`文件夹

### 场景2：自定义输出目录
```bash
python recursive_pdf_classify.py "F:\标准规范要求\充电" --target "符合标准的文档"
```
- 扫描源文件夹
- 将符合标准的PDF复制到`符合标准的文档`文件夹

### 场景3：详细调试模式
```bash
python recursive_pdf_classify.py "F:\标准规范要求\充电" --verbose
```
- 启用详细日志输出
- 便于调试和问题排查

## 注意事项

1. **文件权限**：确保有读取源文件夹和写入目标文件夹的权限
2. **磁盘空间**：确保目标文件夹有足够的磁盘空间
3. **文件名冲突**：自动处理重名文件，添加序号后缀
4. **处理时间**：大文件夹处理时间较长，请耐心等待
5. **内存使用**：每个PDF文件会临时加载到内存中

## 错误处理

- **空PDF文件**：自动跳过并记录
- **损坏文件**：记录错误信息，继续处理其他文件
- **权限问题**：记录错误，跳过无法访问的文件
- **磁盘空间不足**：记录错误，跳过无法复制的文件

## 技术特点

- **高效处理**：只处理第一页，减少处理时间
- **智能检测**：基于颜色分析和形态学检测
- **详细记录**：完整的处理日志和结果统计
- **容错机制**：优雅处理各种异常情况
- **可扩展性**：易于添加新的特征检测规则
