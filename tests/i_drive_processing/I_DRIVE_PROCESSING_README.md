# I盘PDF文件批量处理工具

## 功能说明

这个工具可以：
1. **递归扫描** I:\1T硬盘D 下的所有PDF文件
2. **特征验证** 使用项目的第一特征和第二特征进行PDF质量检测
3. **自动复制** 符合条件的PDF文件到 `jc` 文件夹
4. **详细日志** 所有处理过程记录到 `tests/logs` 目录

## 特征检测标准

### 第一特征：白色背景+黑色文字
- 白色背景占比 ≥ 95%
- 黑色文字占比 ≥ 0.1%
- 整体亮度 ≥ 244
- 对比度 ≥ 26

### 第二特征：两条长黑横线
- 检测PDF中是否存在两条长黑横线
- 使用项目的专门检测算法

## 使用方法

### 方法1：直接运行Python脚本
```bash
python process_i_drive_pdfs.py
```

### 方法2：使用批处理文件（推荐Windows用户）
双击运行 `run_i_drive_processing.bat`

## 文件说明

- `process_i_drive_pdfs.py` - 主要的Python处理脚本
- `run_i_drive_processing.bat` - Windows批处理文件
- `jc/` - 符合条件的PDF文件将被复制到这里
- `tests/logs/` - 处理日志文件保存位置

## 处理流程

1. **环境检查** - 检查Python环境和依赖包
2. **权限验证** - 验证对I盘的访问权限
3. **递归扫描** - 扫描I盘下所有PDF文件
4. **特征检测** - 对每个PDF进行两阶段特征验证
5. **文件复制** - 符合条件的文件复制到jc文件夹
6. **日志记录** - 详细记录处理过程和结果

## 输出结果

### 控制台输出
- 实时显示处理进度
- 显示每个文件的检测结果
- 最终统计信息

### 日志文件
- 文件名格式：`i_drive_processing_YYYYMMDD_HHMMSS.log`
- 包含详细的处理过程和错误信息

### 复制的文件
- 位置：`jc/` 文件夹
- 只包含通过两阶段特征检测的PDF文件

## 注意事项

1. **处理时间** - 根据PDF文件数量和大小，处理可能需要很长时间
2. **磁盘空间** - 确保有足够的磁盘空间存储复制的文件
3. **权限要求** - 需要读取I盘的权限和写入jc文件夹的权限
4. **中断处理** - 可以按Ctrl+C中断处理过程

## 错误处理

- 自动记录所有错误到日志文件
- 显示详细的错误信息和堆栈跟踪
- 继续处理其他文件，不会因为单个文件错误而停止

## 依赖要求

确保已安装以下Python包：
- PyMuPDF (fitz)
- OpenCV (cv2)
- PIL (Pillow)
- numpy

可以通过以下命令安装：
```bash
pip install -r requirements.txt
```

## 技术支持

如果遇到问题，请检查：
1. Python环境是否正确安装
2. 依赖包是否完整安装
3. 对I盘的访问权限
4. 日志文件中的详细错误信息
